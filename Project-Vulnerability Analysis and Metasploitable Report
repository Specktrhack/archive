Vulnerability Analysis and Metasploitable Report
![alt text](https://img.shields.io/badge/Status-Completed-success)

![alt text](https://img.shields.io/badge/Language-English-blue)

![alt text](https://img.shields.io/badge/License-MIT-green)
Author: Haydar Can Kotanoglu
Training Institution: Oak Academy
Completion Date: 08/06/2025
üìú About This Project
This project covers the detection and analysis of security vulnerabilities in publicly exposed services on designated target systems: a Metasploitable virtual machine and a Windows Host. Using discoveries from Nmap, vulnerability scans from Nessus, and local command outputs from the systems, this report details potential risks, exploitation scenarios, and remediation recommendations.
üéØ Project Purpose
To identify active services and their versions on the target systems.
To detect known security vulnerabilities using automated scanning tools (Nessus).
To analyze the risk levels of the detected vulnerabilities and prioritize critical ones.
To outline potential exploitation scenarios, including relevant Metasploit modules.
To provide actionable recommendations to improve the overall security posture of the systems.
üõ†Ô∏è Information Gathering and Discovery Steps
The foundation of any cybersecurity assessment is the information gathering and discovery process, which typically includes the following steps:
IP Address and Network Information Discovery: Identifying the network location (IP addresses) of the target systems.
Service Detection (Port Scanning): Using tools like Nmap to identify running network services (HTTP, FTP, SSH, etc.) and their corresponding port numbers. Example command:
Generated bash
nmap -sV -sC -p- <target_ip>
Use code with caution.
Bash
Operating System Detection: Estimating the operating system and version of the target systems.
Vulnerability Scanning: Using automated tools like Nessus to scan for known vulnerabilities against a vast database.
üêß Metasploitable Host (10.10.1.2) Analysis
The Metasploitable virtual machine, with the IP address 10.10.1.2, is a test system intentionally designed with numerous security vulnerabilities.
1. Tools and Information Sources
Nessus Professional (v10.8.4): Used for vulnerability scanning with Advanced Scan and Basic Network Scan policies.
Nmap (Network Mapper): Used for comprehensive port scanning and service version detection.
Linux Command-Line Tools: Local system information was gathered using commands like uname -a, uptime, df -h, sudo dmidecode, and cat /etc/passwd.
2. System Information
Operating System: Linux metasploitable 2.6.24-16-server (based on Ubuntu 8.04).
Hardware: QEMU virtual machine, 2000 MHz CPU, 2048 MB RAM.
User Accounts: Numerous system and user accounts were found, including root, msfadmin, postgres, and user. The password for msfadmin was identified as "msfadmin". Many user passwords were set to never expire.
3. Network Services and Port Information
PORT	PROTOCOL	SERVICE	VERSION
21	TCP	FTP	vsftpd 2.3.4
22	TCP	SSH	OpenSSH 4.7p1
23	TCP	Telnet	Linux telnetd
25	TCP	SMTP	Postfix smtpd
53	DNS	DNS	ISC BIND 9.4.2
80	HTTP	HTTP	Apache httpd 2.2.8
111	TCP	RPCbind	rpcbind
139	TCP	NetBIOS-SSN	Samba smbd 3.0.20-Debian
445	TCP	SMB	Samba smbd 3.0.20-Debian
512	TCP	rsh	netkit-rsh rexecd
513	TCP	rlogin	xinetd
1099	TCP	Java RMI	grmiregistry
1524	TCP	Bind Shell	Metasploitable root shell
2049	TCP	NFS	NFS Versions 2-4
2121	TCP	FTP	ProFTPD 1.3.1
3306	TCP	MySQL	MySQL 5.0.51a-3ubuntu5
3632	TCP	distccd	distccd v1
5432	TCP	PostgreSQL	PostgreSQL DB 8.3.1
5900	TCP	VNC	Xtightvnc
6000	TCP	X11	X11
6667	TCP	IRC	UnrealIRCd 3.2.8.1
8009	TCP	AJP13	Apache-Coyote/1.1
8180	TCP	Apache Tomcat	Apache Tomcat/Coyote JSP engine 1.1
8787	TCP	Ruby DRb	Ruby DRb RMI (Ruby 1.8)
4. Detected Vulnerabilities and Findings
üî¥ Critical Vulnerabilities
Bind Shell Backdoor (Port 1524): An unauthenticated backdoor providing direct root shell access.
Bash "Shellshock" Vulnerability (CVE-2014-6271): A critical vulnerability allowing Remote Code Execution (RCE) through environment variables.
Debian OpenSSH Weak Key Generation (CVE-2008-0166): SSH keys are predictable, making them vulnerable to brute-force attacks.
Apache Tomcat "Ghostcat" Vulnerability (CVE-2020-1938): A file inclusion and potential RCE vulnerability via the AJP connector.
Insecure SSL/TLS Protocols (SSLv2, SSLv3): The SMTP and PostgreSQL services support outdated and insecure protocols.
üü° High-Severity Vulnerabilities
Samba "Badlock" Vulnerability (CVE-2016-2118): A vulnerability that allows for man-in-the-middle (MITM) attacks.
rlogin / rsh Services: Insecure, unencrypted remote login services are active.
Medium-Strength Cipher Suites (SWEET32 - CVE-2016-2183): Support for weak cipher suites like 3DES.
End-of-Life (EOL) Software:
Operating System: Ubuntu 8.04 (End of support: April 2013).
Apache Tomcat: v5.5 (End of support: September 2012).
5. Potential Metasploit Exploitation Scenarios
vsftpd 2.3.4 Backdoor:
Module: exploit/unix/ftp/vsftpd_234_backdoor
Scenario: Gaining a root shell session by sending a malicious username to the FTP server.
UnrealIRCd Backdoor:
Module: exploit/unix/irc/unreal_ircd_3281_backdoor
Scenario: Executing arbitrary code by sending a specific command string to the IRC server.
Java RMI Server:
Module: exploit/multi/misc/java_rmi_server
Scenario: Achieving RCE by deploying a malicious Java payload through the misconfigured RMI service.
üíª Windows Host (10.10.1.29) Analysis (Uncredentialed Scan)
An uncredentialed scan was performed on the Windows host at IP address 10.10.1.29.
1. System Information
Operating System Guess: Microsoft Windows 10
Hostname: Std19
Active Services:
Port 3389/TCP: Remote Desktop Protocol (RDP)
Port 5355/UDP: Link-Local Multicast Name Resolution (LLMNR)
2. Detected Vulnerabilities and Findings
üü° High-Severity Vulnerabilities
SSL Medium Strength Cipher Suites (SWEET32 - CVE-2016-2183): The RDP service supports weak cipher suites like 3DES.
üü† Medium-Severity Vulnerabilities
TLS 1.0 / TLS 1.1 Support: The RDP service supports deprecated and insecure TLS protocols.
Untrusted SSL Certificate: The RDP service uses a self-signed SSL certificate.
‚ÑπÔ∏è Informational Findings
SMBv1 Support: The system supports the insecure SMBv1 protocol.
üõ°Ô∏è General Security Recommendations
Patch Management: All operating systems and applications (especially Apache, Samba, OpenSSH) must be immediately updated to their latest, secure versions. The End-of-Life Ubuntu 8.04 system should be replaced with a modern, supported OS.
Secure Configuration:
Disable unnecessary and insecure services (Telnet, rlogin, rsh).
Disable weak SSL/TLS protocols (SSLv2, SSLv3, TLS 1.0, TLS 1.1) and cipher suites (3DES, RC4) on all services. Enforce the use of TLS 1.2+ with strong ciphers (e.g., AES-GCM).
Backdoor Remediation: Critical backdoors, such as the root shell on port 1524 of the Metasploitable system, must be closed immediately, and a full system integrity check should be performed.
Network Security: Use firewalls to restrict access to only essential ports. Disable the SMBv1 protocol on all systems.
Identity and Access Management:
Enforce the use of strong, unique passwords for all accounts. Change default passwords (e.g., msfadmin:msfadmin) immediately.
Prefer key-based authentication for SSH access over password-based authentication.
Regular Security Scans: Conduct regular authenticated (credentialed) vulnerability scans to continuously monitor the security posture of the systems.
